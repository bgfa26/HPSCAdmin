/****** 
		PROCEDIMIENTO PARA AGREGAR EMPLEADOS A LA BASE DE DATOS (NO POSEEN NINGUN ROL) 
		FECHA: 20/06/2019 11:00 AM
******/
USE [MTGROUPDATABAS]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[CREATE_EMPLOYEE]
  @id AS int,
  @workerid AS varchar (20),
  @firstname AS varchar (50),
  @lastname AS varchar (50),
  @email AS varchar (120),
  @password AS varchar (50)
AS
BEGIN
  IF ((SELECT COUNT(*) FROM EMPLOYEE WHERE ID = @id) = 0)
    IF ((SELECT COUNT(*) FROM EMPLOYEE WHERE WORKERID = @workerid) = 0)
      IF ((SELECT COUNT(*) FROM EMPLOYEE WHERE EMAIL = @email) = 0)
        BEGIN
          INSERT INTO EMPLOYEE VALUES(@id, @workerid, @firstname, @lastname, @email, @password, 1);
          RETURN 200;
        END;
      ELSE
        RETURN 103;
    ELSE
      RETURN 102;  
  ELSE
    RETURN 101;  
END

/****** 
    PROCEDIMIENTO PARA CONSULTAR EMPLEADOS MEDIANTE UN CORREO
    FECHA: 24/06/2019 12:39 PM
******/
USE [MTGROUPDATABAS]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[CONSULT_EMPLOYEE_EMAIL]
  @email AS varchar(350)
AS
BEGIN
  SELECT E.E_CORREO, E.E_NOMBRE1, E.E_APELLIDO1, E.E_USUARIO, E.E_PASSWORD, R.R_NIVELPRIVILEGIO FROM EMPLOYEE E, ASSIGNMENT A, POSITION P, ORGANIZATIONAL_UNIT OU WHERE [E_USUARIO] = @emp_usuario AND R.R_ID=E.E_FK_ROL;
END